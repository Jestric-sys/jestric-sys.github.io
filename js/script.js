function parseGuess(e){let t=["A","B","C","D","E","F","G"];if(null===e||2!==e.length)alert("Ой, ошибка! Пожалуйста введите букву и цифру указанные на доске доске!");else{let i=e.charAt(0),s=t.indexOf(i),n=e.charAt(1);if(isNaN(s)||isNaN(n))alert("Упс, этого нет на доске!");else{if(!(s<0||s>=model.boardSize||n<0||n>=model.boardSize))return s+n;alert("Ой, не верные координаты!")}}return null}function init(){document.getElementById("fireButton").onclick=handleFireButton;document.getElementById("guessInput").onkeypress=handleKeyPress,model.generateShipLocations()}function handleKeyPress(e){let t=document.getElementById("fireButton");if(13===e.keyCode)return t.click(),!1}function handleFireButton(){let e=document.getElementById("guessInput"),t=e.value;controller.processGuess(t),e.value=""}let view={displayMessage:function(e){document.getElementById("messageArea").innerHTML=e},displayHit:function(e){document.getElementById(e).setAttribute("class","hit")},displayMiss:function(e){document.getElementById(e).setAttribute("class","miss")}},model={boardSize:7,numShips:3,shipLength:3,shipsSunk:0,ships:[{locations:[0,0,0],hits:["","",""]},{locations:[0,0,0],hits:["","",""]},{locations:[0,0,0],hits:["","",""]}],fire:function(e){for(let t=0;t<this.numShips;t++){let i=this.ships[t],s=i.locations.indexOf(e);if(s>=0)return i.hits[s]="hit",view.displayHit(e),view.displayMessage("Попадание!"),this.isSunk(i)&&(view.displayMessage("Вы потопили корабль!"),this.shipsSunk++),!0}return view.displayMiss(e),view.displayMessage("Промах!"),!1},isSunk:function(e){for(let t=0;t<this.shipLength;t++)if("hit"!==e.hits[t])return!1;return!0},generateShipLocations:function(){let e;for(let t=0;t<this.numShips;t++){do{e=this.generateShip()}while(this.collision(e));this.ships[t].locations=e}},generateShip:function(){let e,t,i=Math.floor(2*Math.random());1===i?(e=Math.floor(Math.random()*this.boardSize),t=Math.floor(Math.random()*(this.boardSize-this.shipLength))):(e=Math.floor(Math.random()*(this.boardSize-this.shipLength)),t=Math.floor(Math.random()*this.boardSize));let s=[];for(let n=0;n<this.shipLength;n++)1===i?s.push(e+""+(t+n)):s.push(e+n+""+t);return s},collision:function(e){for(let t=0;t<this.numShips;t++){let i=model.ships[t];for(let t=0;t<e.length;t++)if(i.locations.indexOf(e[t])>=0)return!0}return!1}},controller={guesses:0,processGuess:function(e){let t=parseGuess(e);if(t){this.guesses++;model.fire(t)&&model.shipsSunk===model.numShips&&view.displayMessage("Вы потопили все мои корабли с "+this.guesses+" попытки")}}};window.onload=init;